
:root {
    --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    --radius-sm: 4px; --radius-md: 8px; --radius-lg: 12px;
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.04); --shadow-lg: 0 10px 30px rgba(0,0,0,0.1);

    /* Light Theme Colors */
    --c-disease-light: #d946ef; --c-disease-bg-light: #fae8ff;
    --c-structure-light: #6366f1; --c-structure-bg-light: #e0e7ff;
    --c-process-light: #f97316; --c-process-bg-light: #ffedd5;
    --c-substance-light: #14b8a6; --c-substance-bg-light: #ccfbf1;
    --c-finding-light: #0ea5e9; --c-finding-bg-light: #e0f2fe;
    --c-concept-light: #84cc16; --c-concept-bg-light: #ecfccb;
    --text-light: #1f2937; --bg-light: #f9fafb; --node-bg-light: #ffffff; --bg-alt-light: #f3f4f6;
    --line-light: #e5e7eb; --text-muted-light: #6b7280; --link-light: #4f46e5;

    /* Dark Theme Colors */
    --c-disease-dark: #c084fc; --c-disease-bg-dark: #3b0764;
    --c-structure-dark: #a5b4fc; --c-structure-bg-dark: #3730a3;
    --c-process-dark: #fb923c; --c-process-bg-dark: #4a210b;
    --c-substance-dark: #2dd4bf; --c-substance-bg-dark: #0f766e;
    --c-finding-dark: #38bdf8; --c-finding-bg-dark: #0c4a6e;
    --c-concept-dark: #a3e635; --c-concept-bg-dark: #3f6212;
    --text-dark: #d1d5db; --bg-dark: #111827; --node-bg-dark: #1f2937; --bg-alt-dark: #374151;
    --line-dark: #374151; --text-muted-dark: #9ca3af; --link-dark: #818cf8;
}

:root {
    --bg-color: var(--bg-light); --node-bg: var(--node-bg-light); --bg-alt-color: var(--bg-alt-light);
    --line-color: var(--line-light); --text-color: var(--text-light); --text-muted: var(--text-muted-light);
    --link-color: var(--link-light);
}
html[data-theme='dark'] {
    --bg-color: var(--bg-dark); --node-bg: var(--node-bg-dark); --bg-alt-color: var(--bg-alt-dark);
    --line-color: var(--line-dark); --text-color: var(--text-dark); --text-muted: var(--text-muted-dark);
    --link-color: var(--link-dark);
}

.type-disease   { --type-color: var(--c-disease-light);   --type-bg: var(--c-disease-bg-light); }
.type-structure { --type-color: var(--c-structure-light); --type-bg: var(--c-structure-bg-light); }
.type-process   { --type-color: var(--c-process-light);   --type-bg: var(--c-process-bg-light); }
.type-substance { --type-color: var(--c-substance-light); --type-bg: var(--c-substance-bg-light); }
.type-finding   { --type-color: var(--c-finding-light);   --type-bg: var(--c-finding-bg-light); }
.type-concept   { --type-color: var(--c-concept-light);   --type-bg: var(--c-concept-bg-light); }

html[data-theme='dark'] .type-disease   { --type-color: var(--c-disease-dark);   --type-bg: var(--c-disease-bg-dark); }
html[data-theme='dark'] .type-structure { --type-color: var(--c-structure-dark); --type-bg: var(--c-structure-bg-dark); }
html[data-theme='dark'] .type-process   { --type-color: var(--c-process-dark);   --type-bg: var(--c-process-bg-dark); }
html[data-theme='dark'] .type-substance { --type-color: var(--c-substance-dark); --type-bg: var(--c-substance-bg-dark); }
html[data-theme='dark'] .type-finding   { --type-color: var(--c-finding-dark);   --type-bg: var(--c-finding-bg-dark); }
html[data-theme='dark'] .type-concept   { --type-color: var(--c-concept-dark);   --type-bg: var(--c-concept-bg-dark); }

html { scroll-behavior: smooth; }
body, html { margin:0; padding:0; height:100%; font-family:var(--font-main); background-color:var(--bg-color); color:var(--text-color); transition: background-color .2s, color .2s; -webkit-font-smoothing: antialiased; }
::selection { background-color: var(--type-color, var(--c-structure-light)); color:#fff; }
.emoji { display:inline-block; margin-right:.5em; vertical-align:-0.1em; }

.container { display:flex; height:100vh; }
.nav-panel { width:22%; min-width:280px; background:var(--node-bg); border-right:1px solid var(--line-color); padding:1.25rem; overflow-y:auto; display:flex; flex-direction:column; transition:all .2s; }
.main-panel { flex-grow:1; padding:2.5rem; overflow-y:auto; }
.connections-panel { width:25%; min-width:320px; background:var(--bg-alt-color); border-left:1px solid var(--line-color); padding:1.25rem; overflow-y:auto; transition:all .2s; }

.nav-controls { display:flex; gap:.5rem; margin-bottom:1rem; }
.import-btn, .theme-btn { flex-grow:1; font-family:var(--font-main); font-size:14px; padding:.6rem .75rem; border-radius:var(--radius-md); border:1px solid var(--line-color); background:transparent; color:var(--text-muted); cursor:pointer; display:flex; align-items:center; justify-content:center; gap:.5rem; transition:all .2s; font-weight:500; }
.import-btn { background-color: var(--c-structure-light); color:#fff; border-color:transparent; }
html[data-theme='dark'] .import-btn { background-color: var(--c-structure-dark); }
.theme-btn:hover { background-color:var(--bg-alt-color); color:var(--text-color); border-color:var(--text-muted); }

#search-input { width:100%; box-sizing:border-box; font-family:var(--font-main); font-size:14px; padding:.6rem .8rem; border-radius:var(--radius-md); border:1px solid var(--line-color); background-color:var(--bg-alt-color); color:var(--text-color); margin-bottom:1rem; }
#search-input:focus { outline:none; border-color:var(--c-structure-light); box-shadow:0 0 0 2px var(--c-structure-bg-light); }
html[data-theme='dark'] #search-input:focus { border-color:var(--c-structure-dark); box-shadow:0 0 0 2px var(--c-structure-bg-dark); }

.nav-panel h3 { margin:0 0 .5rem 0; font-size:1rem; text-transform:uppercase; letter-spacing:.05em; color:var(--text-muted); }
.nav-panel ul { list-style:none; padding-left:0; }
.nav-panel a { text-decoration:none; color:var(--text-muted); cursor:pointer; padding:.5rem .75rem; border-radius:var(--radius-md); font-weight:500; transition:background-color .2s, color .2s; display:flex; align-items:center; justify-content:space-between; gap:.25rem; margin-bottom:2px; }
.nav-panel a .topic-title { display:flex; align-items:center; gap:.25rem; }
.nav-panel a:hover { background-color:var(--bg-alt-color); color:var(--text-color); }
.nav-panel a.active { background-color:var(--type-bg); color:var(--type-color); font-weight:600; }

/* hierarchical navigation */
#nav-list details { margin-left:1rem; }
#nav-list summary { font-weight:600; color:var(--text-color); cursor:pointer; padding:.5rem; border-radius:var(--radius-md); list-style-position:inside; }
#nav-list summary:hover { background-color:var(--bg-alt-color); }
#nav-list details ul { padding-left:.5rem; border-left:1px solid var(--line-color); margin-left:.5rem; }
#nav-list details[open] > summary { margin-bottom:.25rem; }

/* search results */
.relevance-score { font-size:.75em; color:var(--text-muted); background-color:var(--bg-alt-color); padding:2px 6px; border-radius:99px; }
a:hover .relevance-score { background-color:var(--node-bg); }
a.active .relevance-score { background-color:var(--node-bg); color:var(--type-color); }

.topic-header { display:flex; justify-content:space-between; align-items:flex-start; border-bottom:1px solid var(--line-color); padding-bottom:1rem; margin-bottom:1.5rem; }
.topic-header-main { display:flex; align-items:center; gap:1rem; }
.topic-icon { font-size:2rem; width:48px; height:48px; flex-shrink:0; border-radius:var(--radius-md); background-color:var(--type-bg); display:flex; align-items:center; justify-content:center; }
.topic-header h2 { margin:0; font-size:2.25rem; }
.tags-container { margin-top:.5rem; display:flex; flex-wrap:wrap; gap:.5rem; }
.tag-item { background-color:var(--bg-alt-color); border:1px solid var(--line-color); color:var(--text-muted); padding:2px 8px; border-radius:99px; font-size:.75em; font-weight:500; }
.topic-header button { font-family:var(--font-main); background:var(--bg-alt-color); color:var(--text-color); border:1px solid var(--line-color); padding:.5rem 1rem; border-radius:var(--radius-md); cursor:pointer; font-weight:500; transition:all .2s; }
.topic-header button:hover { background-color:var(--line-color); border-color:var(--text-muted); }

h4 .emoji { font-size:.9em; }
.at-a-glance { padding:1.25rem; margin-bottom:1.5rem; border-radius:var(--radius-md); background:var(--type-bg); border-left:4px solid var(--type-color); color:var(--type-color);}
.at-a-glance ul { margin:0; padding-left:1.25rem; }
.at-a-glance li, .at-a-glance p, .at-a-glance b, .at-a-glance strong { color:inherit; }

.classification-path { color:var(--text-muted); font-size:.9em; margin-bottom:1.5rem; }
.internal-link { color:var(--link-color); font-weight:600; text-decoration:none; border-bottom:1px solid transparent; transition:border-color .2s; }
.internal-link:hover { border-color:currentColor; }

.connections-panel h3, .connections-panel h4 { margin-top:0; }
.connections-panel ul { list-style:none; padding:0; margin-bottom:1.5rem; }
.connections-panel li { background-color:var(--node-bg); border-radius:var(--radius-md); padding:.75rem 1rem; margin-bottom:.5rem; box-shadow:var(--shadow-sm); border:1px solid var(--line-color); }
.connection-label { font-size:.7rem; font-weight:700; text-transform:uppercase; letter-spacing:.05em; padding:.2em .6em; border-radius:var(--radius-sm); margin-left:.5rem; }

#popover { display:none; position:absolute; background-color:var(--node-bg); border:1px solid var(--line-color); box-shadow:var(--shadow-lg); padding:1rem; z-index:1000; max-width:320px; border-radius:var(--radius-lg); pointer-events:none; }
.modal { display:none; position:fixed; z-index:100; left:0; top:0; width:100%; height:100%; background-color:rgba(17,24,39,0.8); backdrop-filter: blur(4px); }
.modal-content { background-color:var(--bg-color); margin:5% auto; padding:20px; border:1px solid var(--line-color); width:80%; max-width:1200px; height:80%; display:flex; flex-direction:column; border-radius:var(--radius-lg); box-shadow:var(--shadow-lg); }
.modal-header { display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--line-color); padding-bottom:10px; margin-bottom:1rem; }
.close-btn { color:var(--text-muted); font-size:28px; font-weight:bold; cursor:pointer; }
.close-btn:hover { color:var(--text-color); }

/* Graph container needs explicit size */
#graph-container {
    width:100%;
    height:calc(100% - 60px);  /* reserve space for modal header */
    min-height:480px;          /* safety for small viewports */
}
